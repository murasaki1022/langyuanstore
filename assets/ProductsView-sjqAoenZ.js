import{a as p}from"./axios-L6U4YIEh.js";import{M as f}from"./bootstrap.esm-owtkFIww.js";import{_ as P,o as a,c as l,a as t,d as _,t as r,F as m,q as g,b as $,r as v}from"./index-UHJxXFhq.js";const y={data(){return{delProductModal:null}},methods:{openModal(){this.delProductModal.show()},hideModal(){this.delProductModal.hide()}},props:["tempProduct","deleteProduct"],mounted(){this.delProductModal=new f(this.$refs.delProductModal,{keyboard:!1,backdrop:"static"})}},w={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},x={class:"modal-dialog"},k={class:"modal-content border-0"},A=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),E={class:"modal-body"},L={class:"text-danger"},N={class:"modal-footer"},V=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function C(d,e,o,b,u,n){return a(),l("div",w,[t("div",x,[t("div",k,[A,t("div",E,[_(" 是否刪除 "),t("strong",L,r(o.tempProduct.title),1),_(" 商品(刪除後將無法恢復)。 ")]),t("div",N,[V,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...h)=>o.deleteProduct&&o.deleteProduct(...h))}," 確認刪除 ")])])])],512)}const I=P(y,[["render",C]]);var D={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io",VITE_APP_API_NAME:"langyuanstore",BASE_URL:"/langyuanstore/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:i,VITE_APP_API_NAME:c}=D,U={data(){return{products:[],isNew:!1,tempProduct:{imagesUrl:[]},pages:{}}},methods:{getProductList(d=1){const e=`${i}/v2/api/${c}/admin/products?page=${d}`;p.get(e).then(o=>{this.products=o.data.products,this.pages=o.data.pagination}).catch(o=>{console.log(o)})},openModal(d,e){d==="new"?(this.tempProduct={imagesUrl:[]},this.isNew=!0,this.$refs.pModal.openModal()):d==="edit"?(this.tempProduct={...e},Array.isArray(this.tempProduct.imagesUrl)||(this.tempProduct.imagesUrl=[]),this.isNew=!1,this.$refs.pModal.openModal()):d==="delete"&&(this.tempProduct={...e},this.$refs.removeModal.openModal())},updateProduct(){let d=`${i}/v2/api/${c}/admin/product/${this.tempProduct.id}`,e="put";this.isNew&&(d=`${i}/v2/api/${c}/admin/product`,e="post"),p[e](d,{data:this.tempProduct}).then(o=>{alert(o.data.message),this.$refs.pModal.hideModal(),this.getProductList()}).catch(o=>{alert(o.data.message)})},deleteProduct(){const d=`${i}/v2/api/${c}/admin/product/${this.tempProduct.id}`;p.delete(d).then(e=>{alert(e.data.message),this.$refs.removeModal.hideModal(),this.getProductList()}).catch(e=>{alert(e.data.message)})}},components:{DeleteProductModal:I},mounted(){this.getProductList()}},R={class:"container"},T={class:"text-end"},B={class:"table mt-4"},S=t("thead",null,[t("tr",null,[t("th",{width:"120"},"分類"),t("th",{width:"120"},"產品名稱"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"100"},"編輯")])],-1),F={class:"text-end"},O={class:"text-end"},q={key:0,class:"text-success"},j={key:1},z={class:"btn-group"},G=["onClick"],H=["onClick"];function J(d,e,o,b,u,n){const h=v("DeleteProductModal");return a(),l(m,null,[t("div",R,[t("div",T,[t("button",{class:"btn btn-primary mt-4",onClick:e[0]||(e[0]=s=>n.openModal("new"))}," 建立新的產品 ")]),t("table",B,[S,t("tbody",null,[(a(!0),l(m,null,g(u.products,s=>(a(),l("tr",{key:s.id},[t("td",null,r(s.category),1),t("td",null,r(s.title),1),t("td",F,"$"+r(s.origin_price),1),t("td",O,"$"+r(s.price),1),t("td",null,[s.is_enabled?(a(),l("span",q,"啟用")):(a(),l("span",j,"未啟用"))]),t("td",null,[t("div",z,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:M=>n.openModal("edit",s)}," 編輯 ",8,G),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:M=>n.openModal("delete",s)}," 刪除 ",8,H)])])]))),128))])])]),$(h,{"temp-product":u.tempProduct,"delete-product":n.deleteProduct,ref:"removeModal"},null,8,["temp-product","delete-product"])],64)}const X=P(U,[["render",J]]);export{X as default};
