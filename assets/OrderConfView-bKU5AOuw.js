import{a as b}from"./axios-L6U4YIEh.js";import{S as f}from"./sweetalert2.all-LHpgrSOc.js";import{L as A}from"./LangyuanLoading--yfAdZTk.js";import{_ as L,c as u,d as a,b as e,F as h,u as k,t as r,w as v,r as i,o as _,x as E,B as c,z as S,A as C,e as y}from"./index-OnnLlrxQ.js";import"./commonjsHelpers-4gQjN7DL.js";var I={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io",VITE_APP_API_NAME:"langyuanstore",BASE_URL:"/langyuanstore/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:g,VITE_APP_API_NAME:x}=I,N={data(){return{carts:{},form:{user:{name:"",email:"",tel:"",address:""},message:""},orderId:this.$route.params.id}},methods:{getCart(){b.get(`${g}/v2/api/${x}/cart`).then(l=>{this.carts=l.data.data,console.log(l.data.data)}).catch(l=>{console.log(l.response.data.message)})},onSubmit(){const l=this.form;b.post(`${g}/v2/api/${x}/order`,{data:l}).then(t=>{f.fire(t.data.message),this.$refs.form.resetForm(),this.getCart(),this.$router.push(`/payment/${t.data.orderId}`)}).catch(t=>{f.fire({icon:"error",title:t.response.data.message})})},isPhone(l){return/^(09)[0-9]{8}$/.test(l)?!0:"請輸入09開頭，共10碼的正確的電話號碼"}},mounted(){this.getCart()},components:{LangyuanLoading:A}},T={class:"container"},U=e("div",{class:"row justify-content-center"},[e("div",{class:"col-md-10"},[e("h3",{class:"fw-bold mb-4 pt-3"},"訂購人資訊")])],-1),j={class:"row flex-row-reverse justify-content-center pb-5"},B={class:"col-md-4"},D={class:"border p-4 mb-4"},M={class:"w-100"},R={class:"d-flex justify-content-between"},q={class:"mb-0 fw-bold"},z={class:"mb-0"},O={class:"mb-0 fw-bold"},F={class:"table mt-4 border-top border-bottom text-muted"},$=e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"Subtotal",-1),G={class:"text-end border-0 px-0 pt-4"},H=e("tr",null,[e("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"},"Payment"),e("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"ApplePay")],-1),J={class:"d-flex justify-content-between mt-4"},K=e("p",{class:"mb-0 h4 fw-bold"},"Total",-1),Q={class:"mb-0 h4 fw-bold"},W={class:"col-md-6"},X={class:"mb-0"},Y={class:"mb-2"},Z=e("label",{for:"ContactMail",class:"text-muted mb-0"},"收件人Email",-1),ee={class:"mb-2"},te=e("label",{for:"ContactName",class:"text-muted mb-0"},"收件人姓名",-1),se={class:"mb-2"},oe=e("label",{for:"ContactTel",class:"text-muted mb-0"},"收件人電話",-1),le={class:"mb-2"},ae=e("label",{for:"ContactAddress",class:"text-muted mb-0"},"收件人地址",-1),ne={class:"mb-2"},re=e("label",{for:"message",class:"form-label"},"留言",-1),ie={class:"d-flex flex-column-reverse flex-md-row mt-4 justify-content-between align-items-md-center align-items-end w-100"},de=e("button",{type:"button",class:"btn btn-outline-primary btn-lg mb-5 mt-3"},[e("i",{class:"bi bi-chevron-compact-left"}),y(" 回到購物車 ")],-1),me=e("button",{type:"submit",class:"btn btn-primary btn-lg mb-5 mt-3"},[y(" 確認付款"),e("i",{class:"bi bi-chevron-compact-right"})],-1);function ce(l,t,ue,_e,s,p){const w=i("LangyuanLoading"),d=i("v-field"),m=i("error-message"),V=i("router-link"),P=i("v-form");return _(),u(h,null,[a(w,{active:l.isLoading,"onUpdate:active":t[0]||(t[0]=o=>l.isLoading=o)},null,8,["active"]),e("div",T,[U,e("div",j,[e("div",B,[e("div",D,[(_(!0),u(h,null,k(s.carts.carts,o=>(_(),u("div",{class:"d-flex mt-2",key:o.id},[e("div",{class:"me-2",style:E([{width:"48px",height:"48px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${o.product.imageUrl})`}])},null,4),e("div",M,[e("div",R,[e("p",q,r(o.product.title),1),e("p",z,"NT$"+r(o.total),1)]),e("p",O,"x "+r(o.qty)+" / "+r(o.product.unit),1)])]))),128)),e("table",F,[e("tbody",null,[e("tr",null,[$,e("td",G,"NT$"+r(s.carts.final_total),1)]),H])]),e("div",J,[K,e("p",Q,"NT$"+r(s.carts.final_total),1)])])]),e("div",W,[a(P,{ref:"form",onSubmit:p.onSubmit},{default:v(({errors:o})=>[e("div",X,[e("div",Y,[Z,a(d,{id:"email",name:"email",type:"email",class:c(["form-control",{"is-invalid":o.email}]),rules:"email|required",placeholder:"請輸入 Email",modelValue:s.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=n=>s.form.user.email=n)},null,8,["class","modelValue"]),a(m,{name:"email",class:"invalid-feedback"})]),e("div",ee,[te,a(d,{id:"name",name:"收件人姓名",type:"text",class:c(["form-control",{"is-invalid":o.收件人姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:s.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=n=>s.form.user.name=n)},null,8,["class","modelValue"]),a(m,{name:"收件人姓名",class:"invalid-feedback"})]),e("div",se,[oe,a(d,{id:"tel",name:"phone",type:"tel",class:c(["form-control",{"is-invalid":o.phone}]),rules:p.isPhone,placeholder:"請輸入電話",modelValue:s.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=n=>s.form.user.tel=n)},null,8,["rules","class","modelValue"]),a(m,{name:"phone",class:"invalid-feedback"})]),e("div",le,[ae,a(d,{id:"address",name:"收件人地址",type:"text",class:c(["form-control",{"is-invalid":o.收件人地址}]),placeholder:"請輸入地址",rules:"required",modelValue:s.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=n=>s.form.user.address=n)},null,8,["class","modelValue"]),a(m,{name:"收件人地址",class:"invalid-feedback"})]),e("div",ne,[re,S(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=n=>s.form.message=n)},null,512),[[C,s.form.message]])])]),e("div",ie,[a(V,{to:"/cart"},{default:v(()=>[de]),_:1}),me])]),_:1},8,["onSubmit"])])])])],64)}const ge=L(N,[["render",ce]]);export{ge as default};
