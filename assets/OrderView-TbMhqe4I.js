import{a as p}from"./axios-L6U4YIEh.js";import{M as f}from"./bootstrap.esm-owtkFIww.js";import{_ as $,o,c as a,a as e,q as g,F as h,m as M,b as v,r as y,x as k,t as i,A as O,u as w,bp as x}from"./index-f7deKG2Z.js";const P={data(){return{delOrderModal:null}},methods:{openModal(){this.delOrderModal.show()},hideModal(){this.delOrderModal.hide()}},emits:["delete-order"],props:["tempOrder"],mounted(){this.delOrderModal=new f(this.$refs.delOrderModal,{keyboard:!1,backdrop:"static"})}},A={id:"delOrderModal",ref:"delOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"},C={class:"modal-dialog"},D={class:"modal-content border-0"},V=g('<div class="modal-header bg-danger text-white"><h5 id="delOrderModalLabel" class="modal-title"><span>刪除訂單</span></h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"> 是否刪除 <strong class="text-danger">這筆訂單</strong> (刪除後將無法恢復)。 </div>',2),E={class:"modal-footer"},L=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function I(t,s,r,n,c,_){return o(),a("div",A,[e("div",C,[e("div",D,[V,e("div",E,[L,e("button",{type:"button",class:"btn btn-danger",onClick:s[0]||(s[0]=b=>t.$emit("delete-order"))}," 確認刪除 ")])])])],512)}const S=$(P,[["render",I]]);var N={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io",VITE_APP_API_NAME:"langyuanstore",BASE_URL:"/langyuanstore/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:u,VITE_APP_API_NAME:m}=N,R={data(){return{orders:[],tempOrder:{},pages:{}}},methods:{getOrderList(t=1){const s=`${u}/v2/api/${m}/admin/orders?page=${t}`;p.get(s).then(r=>{this.orders=r.data.orders,this.pages=r.data.pagination}).catch(r=>{console.log(r.response.data.message)})},openOrderModal(t){this.tempOrder={...t},this.$refs.orderModal.openModal()},openDelOrderModal(t){this.tempOrder={...t},this.$refs.removeModal.openModal()}},updateOrder(t){const s=`${u}/v2/api/${m}/admin/order/${t.id}`,r={is_paid:t.is_paid};p.put(s,{data:r}).then(n=>{alert(n.data.message),this.$refs.orderModal.hideModal(),this.ge()}).catch(n=>{alert(n.data.message)})},deleteOrder(){const t=`${u}/v2/api/${m}/admin/order/${this.tempOrder.id}`;p.delete(t).then(s=>{alert(s.data.message),this.$refs.removeModal.hideModal(),this.getOrderList()}).catch(s=>{alert(s.data.message)})},components:{DeleteOrderModal:S},mounted(){this.getOrderList()}},U={class:"table mt-4"},B=e("thead",null,[e("tr",null,[e("th",{width:"80"},"購買時間"),e("th",{width:"60"},"Email"),e("th",{width:"150"},"購買品項"),e("th",{width:"80"},"應付金額"),e("th",{width:"60"},"是否付款"),e("th",{width:"60"},"編輯")])],-1),T=e("td",null,null,-1),q=["textContent"],F={class:"list-unstyled"},z={class:"text-right"},j={class:"form-check form-switch"},G=["id","onUpdate:modelValue"],H=["for"],J={key:0},K={key:1},Q={class:"btn-group"},W=["onClick"],X=["onClick"];function Y(t,s,r,n,c,_){const b=y("DeleteOrderModal");return o(),a(h,null,[e("table",U,[B,e("tbody",null,[(o(!0),a(h,null,M(c.orders,d=>(o(),a(h,{key:d.id},[c.orders.length?(o(),a("tr",{key:0,class:k({"text-secondary":!d.is_paid})},[T,e("td",null,[d.user?(o(),a("span",{key:0,textContent:i(d.user.email)},null,8,q)):O("",!0)]),e("td",null,[e("ul",F,[(o(!0),a(h,null,M(d.products,l=>(o(),a("li",{key:l.id},i(l.product.title)+" 數量："+i(l.qty)+" "+i(l.product.unit),1))),128))])]),e("td",z,"$"+i(d.total),1),e("td",null,[e("div",j,[w(e("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${d.id}`,"onUpdate:modelValue":l=>d.is_paid=l},null,8,G),[[x,d.is_paid]]),e("label",{class:"form-check-label",for:`paidSwitch${d.id}`},[d.is_paid?(o(),a("span",J,"已付款")):(o(),a("span",K,"未付款"))],8,H)])]),e("td",null,[e("div",Q,[e("button",{class:"btn btn-outline-primary btn-sm",type:"button",onClick:l=>_.openOrderModal(d)}," 檢視 ",8,W),e("button",{class:"btn btn-outline-danger btn-sm",type:"button",onClick:l=>_.openDelOrderModal(d)}," 刪除 ",8,X)])])],2)):O("",!0)],64))),128))])]),v(b,{"temp-order":c.tempOrder,onDeleteOrder:t.deleteOrder,ref:"removeModal"},null,8,["temp-order","onDeleteOrder"])],64)}const de=$(R,[["render",Y]]);export{de as default};
